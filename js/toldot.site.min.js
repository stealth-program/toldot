toldot.isMobileTemplate=()=>!!document.getElementById("tmb")&&"none"!==window.getComputedStyle(document.getElementById("tmb")).display,toldot.ready.do(),function(){if(document.getElementById("mainMenu")){var t=document.getElementById("mME");function e(){for(var e=t.querySelectorAll("ul"),o=0;o<e.length;o++){e[o].style.width="auto";let t=e[o].querySelector("li").querySelector("a");toldot.isMobileTemplate()||(t.ontouchstart=function(t){toldot.getPopup()||t.preventDefault()})}setTimeout((function(){for(var t=0;t<e.length;t++){var o=e[t].querySelector("li");e[t].style.width=o.offsetWidth+"px"}}),1)}function o(t){if(!toldot.getPopup()||"mMA"!==toldot.getPopup().id){toldot.blockEventPropagation(t);var e=t.currentTarget||t.target;toldot.menu.appearTimer||(toldot.menu.appearTimer=setTimeout((function(){toldot.showPopup(t,e,"bm",!1,"",!1,100),n(t)}),200))}}function n(t){toldot.blockEventPropagation(t);t.currentTarget;clearTimeout(toldot.menu.appearTimer),delete toldot.menu.appearTimer}function l(){toldot.windowWidth=window.innerWidth;setTimeout((function(){window.innerWidth!==toldot.windowWidth?l():(e(),toldot.isResizing=!1)}),500)}t.onmouseover=function(t){o(t)},t.ontouchstart=function(t){o(t)},t.onmouseout=function(t){n(t)},toldot.menu={},e(),window.addEventListener("resize",(function(){toldot.isResizing||(toldot.isResizing=!0,l())}))}}(),function(){if(document.getElementById("LentaForm")&&"none"!==getComputedStyle(document.getElementById("LentaForm")).display&&!toldot.isMobileTemplate()){var t=document.getElementById("LentaForm");function e(t){var e,o,n,l,a,i;return(t=t.split(" "))[0]=t[0].split("-"),t[1]=t[1].split(":"),e=t[0][0],o=Number(t[0][1])-1,n=t[0][2],l=t[1][0],a=t[1][1],i=t[1][2],new Date(e,o,n,l,a,i)}function o(t){return(t="string"==typeof t?new Date(t):t).getFullYear()+"-"+(t.getMonth()+1<10?"0"+String(t.getMonth()+1):String(t.getMonth()+1))+"-"+(t.getDate()<10?"0"+String(t.getDate()):String(t.getDate()))+" "+(t.getHours()<10?"0"+String(t.getHours()):String(t.getHours()))+":"+(t.getMinutes()<10?"0"+String(t.getMinutes()):String(t.getMinutes()))+":"+(t.getSeconds()<10?"0"+String(t.getSeconds()):String(t.getSeconds()))}window.toldot.lenta={form:t,timeInterval:Number(t.refreshTime.value),getItems:function(){toldot.tabIsActive()&&toldot.lenta.stack.length<100?(t.DateLP.value=toldot.lenta.lastItemServerTime,toldot.ajax(toldot.lenta.form,{},toldot.lenta.addItemsToStack,(function(){}))):toldot.lenta.addItemsToStack("[]")},lastUpdate:new Date,stack:[],nowPlaying:!0,counter:0,lastItemServerTime:toldot.getCookie("DateLP"),addItemsToStack:function(t){return function(t){if((t=JSON.parse(t))&&t.length){for(var n=toldot.lenta.timeInterval/t.length,l=0;l<t.length;l++)t[l][2]=n;toldot.lenta.stack=toldot.lenta.stack.concat(t),toldot.lenta.lastItemServerTime=toldot.lenta.stack[toldot.lenta.stack.length-1][0],toldot.lenta.nowPlaying||toldot.lenta.show(),toldot.lenta.counter++}else{n=(new Date).getTime()-toldot.lenta.lastUpdate.getTime();toldot.lenta.lastItemServerTime=o(Date(e(toldot.lenta.lastItemServerTime).getTime+n)),toldot.lenta.counter<30&&(toldot.lenta.setTimeOut=setTimeout((function(){toldot.lenta.getItems()}),toldot.lenta.timeInterval))}toldot.lenta.lastUpdate=new Date}(t)},box:$(".lenta-box"),show:function(){return function(){if(toldot.lenta.stack.length){toldot.lenta.nowPlaying=!0;var t=toldot.lenta.stack[0],e=t[2];if(toldot.lenta.stack.splice(0,1),$.parseHTML(t[1])){(t=$.parseHTML(t[1])[0]).style.display="none",t=$(t);var o=toldot.lenta.box.find(".lenta:last-child"),n=toldot.lenta.box.find(".no-scroll:last");o.fadeOut(1e3,(function(){$(this).remove(),t.css("display","none"),n?t.insertAfter($(n)):t.prependTo(toldot.lenta.box),t.slideDown("slow")}))}toldot.lenta.setTimeOut=setTimeout((function(){toldot.lenta.show()}),e)}else toldot.lenta.nowPlaying=!1,toldot.lenta.getItems()}()},dateServerToJS:function(t){return e(t)},dateJSToServer:function(t){return o(isDate)}},toldot.lenta.setTimeOut=setTimeout((function(){toldot.lenta.show()}),5e3)}}(),function(){if(document.getElementById("TemaSearhForm")){var t=document.querySelector("#TemaSearhForm"),e={},o=t.querySelector("input#theme"),n=t.querySelector("input#themeLabel"),l=t.querySelector("input#themeSearchGetPage"),a=t.querySelector("input#cc_id").value,i=0!=a?"":"&iskeyword=1";function r(e){o.name="",t.action="/"+e+".html"}function d(){return window.location=0==a?t.action:t.action+`?${o.id}=${o.value}`,!1}$(n).autocomplete({source:"/netcat/temasearch.php?cc_id="+a+i,response:function(t,o){o.content.length?o.content.forEach((function(t,o,n){e[t.label.toLowerCase()]=t.value,t.value=t.label})):(o.content[0]={label:"Ничего не найдено",value:""},e["Ничего не найдено"]=0)},select:function(t,l){!function(t,l){var i=e[l.item.value.toLowerCase()];i&&(n.value=l.item.value,0==a?r(i):o.value=i,d())}(0,l)},focus:!1,minLength:2,delay:300}),n.onchange=n.onkeyup=n.onclick=function(){var t,i;t=n.value.trim(),(i=e[t.toLowerCase()]||!1)?(o.value=i,l.disabled=!1,toldot.switchClass(n,"properTheme",!1,!0)):(l.disabled=!0,toldot.switchClass(n,"properTheme",!1,!1)),0==a&&r(i)},t.onsubmit=function(){return d()}}}(),function(){if(document.getElementById("m_holder")){var t=document.documentElement.clientHeight,e=document.getElementById("m_holder"),o=+e.getAttribute("data-list-max-length"),n=+e.getAttribute("data-length"),l=n,a=!1;if(e.setAttribute("data-list-get-from",l),document.getElementById("filterMenu")){a=+(toldot.getCookie("ml")||"0");for(var i=document.getElementById("filterMenu"),r=document.querySelectorAll("ul.filterMenu.additional"),d=i.querySelectorAll("li"),c=0;c<d.length;c++)d[c].onclick=function(){u(this)};m();var s=+e.getAttribute("data-ml");a!==s&&u(i.querySelector('li[data-ml="'+a+'"]'))}function u(t){var o=e.getAttribute("data-blocked"),n=+t.getAttribute("data-ml");if(+e.getAttribute("data-ml")!==n&&"true"!==o){e.setAttribute("data-blocked","true"),e.setAttribute("data-list-get-from","0"),e.setAttribute("data-ml",n),toldot.setCookie("ml",t.getAttribute("data-ml"));for(var l=0;l<d.length;l++)d[l].className="";i.querySelector('li[data-ml="'+n+'"]').className="checked",b(p(),!0),m()}}function m(){if(r)for(var t=0;t<r.length;t++){r[t].innerHTML="";for(var e=0;e<d.length;e++){var o=d[e].cloneNode(!0);o.onclick=function(){u(this)},r[t].appendChild(o)}}}function g(a,i){o>l&&(f(),toldot.scrollingTimer=setInterval((function(){!function(o){var a=+e.getAttribute("data-blockafter");switch(e.getAttribute("data-blocked")){case"true":return"blocked";case"fully":return f(),"stopped";default:if(e.getBoundingClientRect().bottom-t<o){var i=p();l/n<a?b(i):(i.innerHTML="<b>Загрузить еще материалы по теме</b>",f(),i.onclick=function(){b(i)})}}}(i)}),a))}function f(){toldot.scrollingTimer&&clearInterval(toldot.scrollingTimer),toldot.scrollingTimer=!1}function p(){var t=document.createElement("div");return t.className=e.firstElementChild.className,e.appendChild(t),t}function b(t,i){var r=+e.getAttribute("data-id"),d=+e.getAttribute("data-sci"),c=+e.getAttribute("data-filter"),s=e.getAttribute("data-url");a=!1!==a&&+(toldot.getCookie("ml")||"0"),l=+e.getAttribute("data-list-get-from"),e.setAttribute("data-blocked","true"),toldot.blockIsDownloading(!1,!0,i?e:t),toldot.ajax({action:s},{subClassId:d,id:r,length:n,from:l,ml:a,filter:c||""},(function(r){!function(t,i,r){a=!1!==a&&+(toldot.getCookie("ml")||"0"),toldot.blockIsDownloading(!1,!1,r?e:i),t.trim()?(i.style.opacity=0,i.innerHTML=t,r&&(e.innerHTML="",e.appendChild(i)),setTimeout((function(){toldot.switchClass(i,"vis",!1,!0),i.style.opacity=1}),200),i.onclick=!1,o>(l+=n)&&!a?(e.setAttribute("data-list-get-from",l),e.setAttribute("data-blocked","false"),g(1e3,300)):e.setAttribute("data-blocked","fully")):(i.innerHTML="",i.onclick=function(){i.innerHTML="Материалов по этой теме больше нет"},e.setAttribute("data-blocked","fully"))}(r,t,i)}))}g(500,500)}}(),document.getElementById("DeferredForm")&&(window.toldot.defer=function(t,e,o){toldot.blockIsDownloading(!1,!0,t);var n=+t.getAttribute("data-deferred-status")?0:1;toldot.ajax("DeferredForm",{message_id:e,cc:o,operation:n},(function(e){1==(e=JSON.parse(e)).code?(t.setAttribute("data-deferred-status",n),toldot.switchClass(t,"true",!1)):toldot.showWindow(!1,"Ошибка добавления материала",e.code+": "+e.answerHTML),toldot.blockIsDownloading(!1,!1,t)}))}),document.getElementById("SubscribeListForm")&&(window.toldot.subscribe=function(t,e,o,n,l){toldot.blockIsDownloading(!1,!0,t);var a={},i={};switch(i={cc:o,message_id:e,subscribtionType:n},n){case 0:i.author_id=l,a.name="data-subscribe-author-status";break;case 1:i.cycle_id=l,a.name="data-subscribe-cicle-status";break;case 2:a.name="data-subscribe-blog-status"}a.status=+t.getAttribute(a.name),i.operation=a.status?0:1,toldot.ajax("SubscribeListForm",i,(function(e){1==(e=JSON.parse(e)).code?(t.setAttribute(a.name,i.operation),toldot.switchClass(t,"true",!1)):toldot.showWindow(!1,"Ошибка подписки",e.code+": "+e.answerHTML),toldot.blockIsDownloading(!1,!1,t)}))}),null!=toldot.getCookie("ts")&&"0"!=toldot.getCookie("ts")&&toldot.ajax({action:"/netcat/tyac.php",method:"post"},{},(function(t){toldot.deleteCookie("ts");var e=!1;try{e=JSON.parse(t)}catch(t){}if(e){if(e.tysta){if(e.tysta.fabo&&e.tysta.fabo.engagement&&document.getElementById("FBShareCounter")){let t=Number(e.tysta.fabo.engagement.share_count)+Number(e.tysta.fabo.engagement.reaction_count);document.getElementById("FBShareCounter").innerHTML=t||""}if(e.tysta.paco&&(document.getElementById("Article_mark")||document.getElementById("VaadForm"))){let t=document.getElementById("Article_mark")||document.getElementById("VaadForm"),o=document.createElement("div");o.id="pageStats",o.innerHTML="Страница посещена "+e.tysta.paco+" раз",t.appendChild(o)}}if(e.reba){let t=document.querySelector("#mmt + div"),o=document.createElement("div");o.className="bhn",o.innerHTML=e.reba,t.after(o),toldot.softChange(t,o)}}}),(function(){toldot.deleteCookie("ts")})),toldot.showSendErrorWindow=function(t,e){if(window.getSelection()){var o=window.getSelection();if(o.toString().length>0){var n=o.getRangeAt(0),l=n.cloneRange(),a=n.cloneRange();l.selectNodeContents(document.querySelector("body")),a.selectNodeContents(document.querySelector("body")),l.setEnd(n.startContainer,n.startOffset),a.setStart(n.endContainer,n.endOffset);var i=l.toString().slice(t),r=a.toString().slice(0,e),d=document.getElementById("err-report-message");d||((d=document.createElement("span")).setAttribute("id","err-report-message"),d.style.display="none",document.body.appendChild(d)),d.innerHTML="..."+i+"<b style='background-color: #ffe634'>"+o.toString()+"</b>"+r+"...",toldot.showWindow(!1,"","","","/work-zone/popup-windows/error-report/?error_report_url="+encodeURIComponent(document.location.href))}}},function(){if(toldot.scroll=function(t,e,o){var n=void 0,l=void 0;if(t){if("string"==typeof t){if(!(t=document.getElementById(t)||document.querySelector(t)))return}else if(!("object"==typeof e&&e instanceof Node&&document.contains(e)))return;a=t,i=o?a.scrollLeft:a.scrollTop}else{t="html, body";var a=document,i=o?window.pageXOffset||document.documentElement.scrollLeft:window.pageYOffset||document.documentElement.scrollTop}if(e){if(!("string"!=typeof e||(e=document.getElementById(e)||document.querySelector('a[name ="'+e+'"]')||document.querySelector(e))&&a.contains(e)))return;if(!("object"==typeof e&&e instanceof Node&&a.contains(e)))return;o?l=e.getBoundingClientRect().left+i:n=e.getBoundingClientRect().top+i}else n=0;toldot.scroll.do=function(){$(t).animate({scrollTop:n,scrollLeft:l},500,(function(){!o&&t===document.body&&toldot.pageAnchor&&(location.hash=toldot.pageAnchor)}))},toldot.scroll.do(),window.onload=function(){toldot.scroll.do()}},toldot.scroll.initLinks=function(){for(var t=document.querySelectorAll('a[href^="#"]:not(.ui-tabs-anchor)'),e=0;e<t.length;e++)t[e].addEventListener("click",(function(t){var e=this.getAttribute("href").split("#");return e=e[e.length-1],toldot.pageAnchor=decodeURIComponent(e),toldot.scroll(0,decodeURIComponent(e)),t.preventDefault(),!1}))},toldot.scroll.initLinks(),toldot.pageAnchor){var t=document.getElementById(toldot.pageAnchor)||document.querySelector('[name="'+toldot.pageAnchor+'"]');t?toldot.scroll(!1,t):location.hash=toldot.pageAnchor}}(),function(){if(document.getElementById("ssa")){var t=Number(toldot.getCookie("vs"))||0;toldot.setCookie("vs",t+1,{expires:31556952,path:"/"}),t<5?toldot.setCookie("shmomesba",1,{expires:31556952,path:"/"}):toldot.getCookie("shmomesba")&&(t>=5&&(document.getElementById("ssa").className="opened",toldot.getPutAjaxData("/work-zone/ajax/messengers/","ssaBL")),t>=7&&setTimeout((function(){document.getElementById("ssaBut").click()}),500))}}(),toldot.footer={multilineToggle:function(t){t.parentNode.querySelectorAll("div>span").forEach((e=>(e!=t&&e.classList.toggle("opened",!1),!0))),t.classList.toggle("opened")},tgwaToggle:function(t,e){let o=t.querySelector("div");this.multilineToggle(t),t.classList.toggle("opened")&&(toldot.blockIsDownloading(event,!0,o),toldot.ajax({action:"/work-zone/ajax/messengers/"},{},(function(n){toldot.blockIsDownloading(!1,!1,o),o.innerHTML=n,t.querySelector("."+e+".ssaDi").style.display="block",setTimeout((function(){toldot.scroll(!1,o)}),1)}),(function(){})))}};